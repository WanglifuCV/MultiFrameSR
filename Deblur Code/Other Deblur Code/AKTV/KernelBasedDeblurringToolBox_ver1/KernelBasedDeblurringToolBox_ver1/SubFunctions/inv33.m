function y = inv33(x)

[N M num] = size(x);
D = zeros(N, M);
y = zeros(N, M, 9);
y(:,:,1) = (x(:,:,5) .* x(:,:,9) - x(:,:,6) .* x(:,:,8));
y(:,:,4) = (x(:,:,7) .* x(:,:,6) - x(:,:,9) .* x(:,:,4));
y(:,:,7) = (x(:,:,4) .* x(:,:,8) - x(:,:,5) .* x(:,:,7));
D = x(:,:,1) .* y(:,:,1) + x(:,:,2) .* y(:,:,4) + x(:,:,3) .* y(:,:,7);
D = (D .* (~(D < 0.0001))) + ((D < 0.0001) * 0.0001);
y(:,:,1) = y(:,:,1) ./ D;
y(:,:,2) = (x(:,:,8) .* x(:,:,3) - x(:,:,9) .* x(:,:,2)) ./ D;
y(:,:,3) = (x(:,:,2) .* x(:,:,6) - x(:,:,3) .* x(:,:,5)) ./ D;
y(:,:,4) = y(:,:,4) ./ D;
y(:,:,5) = (x(:,:,1) .* x(:,:,9) - x(:,:,3) .* x(:,:,7)) ./ D;
y(:,:,6) = (x(:,:,4) .* x(:,:,3) - x(:,:,6) .* x(:,:,1)) ./ D;
y(:,:,7) = y(:,:,7) ./ D;
y(:,:,8) = (x(:,:,7) .* x(:,:,2) - x(:,:,8) .* x(:,:,1)) ./ D;
y(:,:,9) = (x(:,:,1) .* x(:,:,5) - x(:,:,2) .* x(:,:,4)) ./ D;